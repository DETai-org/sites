# Document Taxonomy Policy

**v1.0**

## Назначение

Данный документ определяет **правила формирования таксономии конкретного документа**
(поста, публикации, цитаты и др.) в системе **DET / DETai**.

## 1. Что такое taxonomy документа

Таксономия документа — это **осознанная привязка текста** к:

* концептуальному вектору (rubric),
* уточняющим аспектам (categories),
* эмпирическим маркерам текста (keywords).

Taxonomy используется для:

* навигации,
* аналитики,
* выявления структурных закономерностей,
* роста rubrics и subrubrics.

---

## 2. Общий принцип (обязательный)

> **Документ не хранит произвольные строки,
> он ссылается на сущности controlled vocabularies по ID.**

Единственное допустимое исключение — переходные поля, явно разрешённые политикой
(например, `keywords_raw`).

---

## 3. Структура taxonomy блока

```json
"taxonomy": {
  "rubric_ids": [],
  "category_ids": [],
  "cycle_ids": ["cycle_123"],
  "keyword_ids": [],
  "keywords_raw": []
}
```

Все поля опциональны, **кроме rubric_ids**.  
Для `type = post` также требуется обязательная `category_ids` (ровно одна).
Исключение: для документов типа **research_publication** допускаются пустые `rubric_ids`
и `category_ids` (см. раздел 4.1).

---

## 4. Rubric IDs — концептуальный выбор

### Назначение

`rubric_ids` определяют **в каком концептуальном поле мыслится документ**.

Rubric отвечает на вопрос:
**«В рамках какого постулата / главы этот текст имеет смысл?»**

---

### Правила

* Документ **обязан** иметь минимум одну rubric.
* Rubric выбирается **осознанно**, не автоматически.
* Для `type = post` допускается **ровно одна** rubric.
* Для остальных типов допускается несколько rubric_ids, если это оправдано содержательно.
* Можно указывать как `rubric`, так и `subrubric`.

---

### 4.1 Исключение для Research Publication

На текущем этапе рубрики и категории **не присваиваются** научным публикациям.
Для `type = research_publication` допускаются пустые `rubric_ids` и `category_ids`.

Это временное ограничение: в будущем возможно связать рубрики/категории постов
с научными публикациями, но пока их роль выполняет подтип документа
`administrative.subtype` (например, `article`, `dissertation`, `thesis`).

---

### Недопустимо

❌ Использовать rubric как тег
❌ Создавать rubric под отдельный документ
❌ Назначать rubric “для охвата”

---

## 5. Category IDs — уточняющий ракурс

### Назначение

`category_ids` — это **поперечные фильтры**, уточняющие аспект рассмотрения.

Category отвечает на вопрос:
**«С какой стороны рассматривается тема?»**

---

### Правила

* Для `type = post` требуется **ровно одна** category.
* Для остальных типов categories **не обязательны**.
* Categories **не определяют смысл документа**, только уточняют.
---

## 6. Keywords — отражение текста

### 6.1 `keywords_raw`

* свободные строки;
* формируются AI на основе текста;
* отражают фактическое содержание;
* допустимы на переходном этапе.

`keywords_raw` — это **входной аналитический слой**, а не финальное состояние.

---

### 6.2 `keyword_ids`

* ссылки на `approved` keywords из словаря;
* используются после ревью;
* являются устойчивым состоянием.

---

## 7. Cycle IDs — связь постов в цикл

`cycle_ids` — опциональная связь поста с циклом (отдельная сущность).  
Если пост входит в цикл, указывается идентификатор цикла (например, `cycle_123`) —  
в массиве допускается **только один** элемент.  
Для **первого поста цикла** допускается пометка родительского поста суффиксом:  
`cycle_123:Post-announcement`.  
Если пост **не входит** в цикл, поле **не указывается** (пустые значения не используются).

Идентификатор цикла — это его **название**, приведённое к каноническому ID.  
Например, тематический цикл «Сказки о Северном ветре» → `cycle:skazki-o-severnom-vetre`.  
`cycle_123` в примерах — условный пример для демонстрации формата.

---

## 8. Типовые ошибки (anti-patterns)

❌ Использовать строки вместо ID
❌ Подменять rubric категориями
❌ Назначать keywords “по задумке”, а не по тексту
❌ Игнорировать taxonomy при создании документа

---

## 9. Итоговый принцип

Таксономия документа — это **точка встречи структуры и смысла**.

Мы:

* **выбираем rubric осознанно**,
* **уточняем ракурс при необходимости**,
* **даём тексту самому говорить через keywords**,
* и позволяем системе расти **на данных, а не предположениях**.

---

**Статус документа:** canonical
**Последнее обновление:** 2026-01-15
