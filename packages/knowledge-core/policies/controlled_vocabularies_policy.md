
# Controlled Vocabularies Policy

**v1.0** ♻️

## Назначение документа

Данный документ описывает **общую политику управляемых словарей (controlled vocabularies)** в экосистеме **DET / DETai**.

Он является **наддокументом**, определяющим:

* единые правила для всех словарей;
* жизненный цикл сущностей;
* требования к структуре и стабильности данных;
* принципы роста, модерации и эволюции терминологии.

Все частные политики (`keywords_policy`, `rubrics_and_subrubrics_policy` и др.) **наследуют правила**, изложенные здесь.

---

## 1. Что такое controlled vocabulary в системе DET / DETai

**Controlled vocabulary** — это управляемый реестр сущностей, используемых системой для:

* классификации документов,
* семантической навигации,
* аналитики,
* роста интеллектуальной структуры.

Controlled vocabularies **не являются просто справочниками**.
Это **канонические источники смысла**, с которыми взаимодействуют:

* документы,
* AI-агенты,
* аналитические процессы.

---

## 2. Какие словари относятся к controlled vocabularies

К controlled vocabularies относятся (но не ограничиваются):

* `rubrics`
* `categories`
* `keywords`
* будущие словари (concepts, entities, methods и др.)

Каждый словарь:

* хранится отдельно;
* имеет собственную версию;
* подчиняется общей политике.

---

## 3. Общий контракт сущности словаря

Каждый элемент **любой** controlled vocabulary **обязан** иметь следующие поля:

```json
{
  "id": "stable-identifier",
  "type": "entity-type",
  "label": "Human-readable label",
  "description": "Short semantic description",
  "lifecycle": "candidate | approved | deprecated",
  "origin": "manual | ai",
  "created_at": "YYYY-MM-DD",
  "parent_id": "optional-parent-id-or-null"
}
```

### 3.1 Обязательные принципы

* `id` — **стабильный**, никогда не меняется.
* `label` — может уточняться со временем.
* `description` — краткое и понятное описание смысла.
* `lifecycle` — отражает зрелость сущности.
* `parent_id` — используется для иерархий (если применимо).

---

## 4. Принцип стабильности ID (критически важно)

**ID — это якорь системы.**

Запрещено:

* менять `id` существующей сущности;
* переиспользовать `id` для другого смысла;
* удалять сущности физически.

Допустимо:

* менять `label`;
* уточнять `description`;
* переводить в `deprecated`.

Если смысл радикально меняется — создаётся **новая сущность с новым id**.

---

## 5. Жизненный цикл сущностей (lifecycle)

Все controlled vocabularies используют **единый lifecycle**.

### 5.1 `candidate`

* новая сущность;
* добавлена AI или вручную;
* подлежит проверке;
* может быть изменена или объединена.

### 5.2 `approved`

* сущность проверена;
* считается канонической;
* активно используется в системе.

### 5.3 `deprecated`

* сущность устарела или признана неудачной;
* **не используется** в новых данных;
* сохраняется для истории и совместимости.

---

## 6. Origin: источник появления

Поле `origin` фиксирует источник появления сущности:

* `manual` — добавлено человеком;
* `ai` — сгенерировано автоматически.

Origin **не влияет на ценность сущности**,
но важен для анализа и ревью.

---

## 7. Иерархии и parent_id

Иерархии строятся **только через `parent_id`**.

Принципы:

* родитель **не хранит** список детей;
* дочерняя сущность **указывает родителя**;
* отсутствие `parent_id` означает верхний уровень.

Это правило применяется ко всем словарям, где иерархия уместна.

---

## 8. Версионирование словарей

Каждый словарь имеет поле `version`.

Версия:

* отражает **структурные изменения** словаря;
* не обязана меняться при каждом добавлении сущности;
* увеличивается при изменении контракта или политики.

---

## 9. Связь controlled vocabularies и документов

Документы:

* **не хранят произвольные строки**,
  за исключением явно разрешённых переходных полей (например, `keywords_raw`);
* **ссылаются на сущности словарей по id**.

Это обеспечивает:

* целостность данных;
* возможность аналитики;
* масштабируемость.

---

## 10. Роль AI-агентов (Codex, pipeline)

AI-агенты:

* могут **предлагать** новые сущности (`candidate`);
* не имеют права:

  * менять `id`,
  * удалять сущности,
  * переводить в `approved` без правил ревью.

AI действует **в рамках политики**, а не вместо неё.

---

## 11. Анти-паттерны (запрещено)

❌ Использовать строки вместо ID
❌ Менять ID задним числом
❌ Удалять сущности физически
❌ Смешивать разные смыслы в одном ID
❌ Создавать иерархии без parent_id
❌ Игнорировать lifecycle
---

**Статус документа:** canonical
**Последнее обновление:** 2026-01-15


Готов продолжать?
